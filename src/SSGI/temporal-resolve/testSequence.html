<!DOCTYPE html>
<html>
	<head>
		<!--Step 2-->
		<script src="https://d3js.org/d3.v4.min.js"></script>
	</head>
	<body>
		<!--Step 2-->
		<svg id="r2" width="500" height="500" style="margin-right: 64px"></svg>
		<svg id="halton" width="500" height="500" style="margin-right: 64px"></svg>
		<svg id="random" width="500" height="500"></svg>
		<script>
			// from: https://news.ycombinator.com/item?id=17876741
			// reference: http://extremelearning.com.au/unreasonable-effectiveness-of-quasirandom-sequences/
			const generateR2 = count => {
				let points = []
				let g = 1.32471795724474602596090885447809
				let a1 = 1.0 / g
				let a2 = 1.0 / (g * g)

				for (let n = 0; n < count; n++) {
					points.push([(0.5 + a1 * n) % 1, (0.5 + a2 * n) % 1])
				}

				return points
			}

			const halton = (index, base) => {
				let fraction = 1
				let result = 0
				while (index > 0) {
					fraction /= base
					result += fraction * (index % base)
					index = ~~(index / base) // floor division
				}
				return result
			}

			// generates Halton tuples in the range [0:1]
			const generateHalton23Points = count => {
				const data = []

				let i = 1
				const end = i + count

				for (; i < end; i++) {
					data.push([halton(i, 2), halton(i, 3)])
				}

				return data
			}

			let create = (name, id, dataset) => {
				let svg = d3.select(id),
					margin = 200,
					width = svg.attr("width") - margin, //300
					height = svg.attr("height") - margin //200

				let xScale = d3.scaleLinear().domain([0, 1]).range([0, width]),
					yScale = d3.scaleLinear().domain([0, 1]).range([height, 0])

				let g = svg.append("g").attr("transform", "translate(" + 100 + "," + 100 + ")")

				g.append("g")
					.attr("transform", "translate(0," + height + ")")
					.call(d3.axisBottom(xScale))

				g.append("g").call(d3.axisLeft(yScale))

				svg
					.append("text")
					.attr("x", width / 2 + 100)
					.attr("y", 80)
					.attr("text-anchor", "middle")
					.style("font-family", "Helvetica")
					.style("font-size", 20)
					.text(name)

				svg
					.append("g")
					.selectAll("dot")
					.data(dataset)
					.enter()
					.append("circle")
					.attr("cx", function (d) {
						return xScale(d[0])
					})
					.attr("cy", function (d) {
						return yScale(d[1])
					})
					.attr("r", 2)
					.attr("transform", "translate(" + 100 + "," + 100 + ")")
					.style("fill", "#CC0000")
			}

			create("R2", "#r2", generateR2(500))
			create("Halton (2, 3)", "#halton", generateHalton23Points(500))

			create(
				"Math.random()",
				"#random",
				Array(500)
					.fill(null)
					.map(() => [Math.random(), Math.random()])
			)
		</script>
	</body>
</html>
